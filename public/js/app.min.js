(()=>{var r="https://papermaker.labs.zikani.me/api/v1/generate";var o=Vue.createApp({template:document.getElementById("app-template").innerHTML,components:{},data(){return{appTitle:"Paper Maker App",activeTabName:"newPaperTab",title:"",classTerm:"",className:"",schoolName:"",subjectName:"",selectedExamType:null,selectedExamTypeModel:"",outputFormat:"docx",examDate:"",timeAllowed:"",teacherName:"",questions:[],sections:[],columnCount:1,currentQuestionIdx:-1,newSection:{id:"",name:"",displaySectionName:!0},newQuestion:{id:"",title:"",content:"",isMultipleChoice:!1,answerOptions:[]},downloadedData:null,outputName:"",useOfflineMode:!0,isEditingQuestion:!1,isEditingSection:!1,hasMultipleSections:!1,generating:!1,paperGenerated:!1,isWasmModuleLoaded:!1,examTypeColumns:[{value:"free_form",text:"Free Form"}],showExamOptionsPicker:!1,uncollapsedQuestions:[],uncollaps:[]}},computed:{computedTitle(){return this.title.length>0?this.title:`${this.subjectName} - ${this.classTerm}`},isMultipleChoiceSupported(){return this.selectedExamType&&(this.selectedExamType.value=="multiple_choice"||this.selectedExamType.value=="mixed")},hasSections(){return this.sections.length>0},availableSections(){return[]},noOfQuestions(){return this.questions?this.questions.length:0},nextQuestionIdx(){return this.currentQuestionIdx==-1?0:this.currentQuestionIdx+1>this.questions.length-1?questions.length:this.currentQuestionIdx+1},paperFilename(){let t=`${this.subjectName} - ${this.classTerm}`;return t=t.replace("s\\\\//*!#$%",""),`${t} [Generated by Paper Maker App labs.zikani.me].${this.outputFormat}`},downloadedDataBase64URL(){return this.downloadedData}},methods:{resetNewQuestion(){this.newQuestion={id:"",title:"",content:"Type the question here",isMultipleChoice:!1,answerOptions:[]}},prevQuestion(){this.currentQuestionIdx>0&&(this.currentQuestionIdx-=1)},nextQuestion(){this.currentQuestionIdx+=1,this.currentQuestionIdx>this.questions.length-1&&(this.currentQuestionIdx=questions.length-1)},onExamOptionSelected(t){this.selectedExamType=t,this.showExamOptionsPicker=!1},saveOrEditSection(t){let s=Object.assign({},this.newSection,{id:this.sections.length+1});this.sections.push(s),this.isEditingSection=!1},saveOrEditQuestion(t){if(this.newQuestion.content.length<1)return;let s=Object.assign({},this.newQuestion);this.questions.push(s),this.resetNewQuestion(),this.isEditingQuestion=!1},generatePaper(t,s){if(this.useOfflineMode){let e=GeneratePaper(JSON.stringify(t),s);if(e.indexOf("base64")>0)return Promise.resolve(e);let i=new Error("Failed to process request: "+e);return e.indexOf("validationErrors")>0&&(i.data=JSON.parse(e)),Promise.reject(i)}return l(t,s)},submitGenerate(t){t.preventDefault();let s={outputFormat:this.outputFormat,title:this.computedTitle,className:this.className,schoolName:this.schoolName,teacherName:this.teacherName,subjectName:this.subjectName,isDoubleColumn:this.isDoubleColumn,timeAllowed:this.timeAllowed,examDate:this.examDate,questions:this.questions.map((e,i)=>({sortOrder:i+1,section:e.section,title:e.title,content:e.content,questionType:e.questionType,answerOptions:e.answerOptions.map(n=>({content:n.content,isCorrect:n.isCorrect})),image:{url:"",width:"",height:"",alt:"Figure 1"}})),font:{name:this.fontName,size:this.fontSize,file:""}};return this.generating=!0,this.paperGenerated=!1,this.generatePaper(s,this.outputFormat).then(e=>{this.downloadedData=e,this.paperGenerated=!0,this.generating=!1,setTimeout(()=>this.$refs.downloadEl.click(),300),vant.Notify({type:"success",message:"Process completed sucessfully, download will start automatically..."})}).catch(e=>{if(e.data){let n=e.data.validationErrors||["unknown errors"];vant.Notify({type:"warning",message:"\u26A0\uFE0F Validation errors: "+n.join("\xD7 ")});return}vant.Notify({type:"warning",message:"Failed to process request. error: "+e})}),!1}}});o.use(vant);o.use(vant.Lazyload);function l(t,s){return fetch(r,{method:"POST",body:JSON.stringify(t)}).then(e=>e.ok?e.text():e.text().then(i=>{let n=new Error("Failed to process request");return i.indexOf("validationErrors")>0&&(n.data=JSON.parse(i)),Promise.reject(n)}))}window._wasmModuleLoaded=!1;var a=o.mount(document.getElementById("app"));fetch("main.wasm").then(t=>{let s=new Go;WebAssembly.instantiateStreaming(t,s.importObject).then(e=>{window._wasmModuleLoaded=!0,a.isWasmModuleLoaded=!0,s.run(e.instance)}).catch(e=>{vant.Notify({type:"warning",message:"Failed to load resources for Offline functionality. You can still use the app but will need an internet connection. Try to reload the page"}),console.error("Failed to load WASM module, try to reload the page... will use online API to process requests"),window._wasmModuleLoaded=!1,a.isWasmModuleLoaded=!1,a.useOfflineMode=!1})});})();
